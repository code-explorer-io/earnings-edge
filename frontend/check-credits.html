<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check EarningsEdge Credits - Any Domain</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            max-width: 700px;
            margin: 50px auto;
            padding: 20px;
            background: #0a1929;
            color: #E0E0E0;
        }
        .container {
            background: #1e1e1e;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        h1 {
            color: #667eea;
            margin-top: 0;
        }
        .info-box {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .warning {
            background: #3a2a1a;
            border-left-color: #f59e0b;
            color: #fbbf24;
        }
        .success {
            background: #1e3a2a;
            border-left-color: #10b981;
            color: #10b981;
        }
        .error {
            background: #3a1e1e;
            border-left-color: #ef4444;
            color: #fca5a5;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 10px 10px 0;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        .key-value {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #444;
        }
        .key { color: #8b5cf6; font-weight: bold; }
        .value { color: #10b981; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç EarningsEdge Credit Checker</h1>

        <div class="info-box warning">
            ‚ö†Ô∏è <strong>Important:</strong> This tool must be on the SAME DOMAIN as your EarningsEdge app to access its localStorage.
            <br><br>
            <strong>Current domain:</strong> <span id="currentDomain"></span>
        </div>

        <h2>üìä Current Status:</h2>
        <div id="status" class="info-box"></div>

        <h2>üîß All localStorage Keys:</h2>
        <div id="allKeys" class="info-box"></div>

        <h2>‚ö° Quick Actions:</h2>
        <button onclick="setCredits(25)">Set to 25 Credits</button>
        <button onclick="setCredits(10)">Set to 10 Credits</button>
        <button onclick="forceRefresh()">Force Daily Refresh (to 25)</button>
        <button onclick="clearAll()" class="danger">Clear All & Restart</button>
        <button onclick="checkAgain()">Refresh Status</button>

        <h2>üìã Manual Console Commands:</h2>
        <div class="info-box">
            <strong>Set credits to 25:</strong><br>
            <code>localStorage.setItem('earningsEdgeCredits', '25'); location.reload()</code>
            <br><br>
            <strong>Check current credits:</strong><br>
            <code>localStorage.getItem('earningsEdgeCredits')</code>
            <br><br>
            <strong>Clear all and restart:</strong><br>
            <code>localStorage.clear(); location.reload()</code>
        </div>

        <div id="message" style="margin-top: 20px;"></div>
    </div>

    <script>
        const STORAGE_KEYS = {
            CREDITS: 'earningsEdgeCredits',
            WELCOME_USED: 'earningsEdgeWelcomeUsed',
            LAST_REFRESH: 'earningsEdgeLastRefresh',
            SESSION_ID: 'earningsEdgeSessionId',
            PURCHASED_CREDITS: 'earningsEdgePurchasedCredits'
        };

        function showMessage(text, className = 'success') {
            const msgDiv = document.getElementById('message');
            msgDiv.className = 'info-box ' + className;
            msgDiv.innerHTML = text;
        }

        function getCurrentCredits() {
            const credits = localStorage.getItem(STORAGE_KEYS.CREDITS);
            return credits ? parseInt(credits, 10) : 0;
        }

        function checkAgain() {
            updateStatus();
            showMessage('‚úÖ Status refreshed!', 'success');
        }

        function updateStatus() {
            const credits = getCurrentCredits();
            const sessionId = localStorage.getItem(STORAGE_KEYS.SESSION_ID);
            const welcomeUsed = localStorage.getItem(STORAGE_KEYS.WELCOME_USED);
            const lastRefresh = localStorage.getItem(STORAGE_KEYS.LAST_REFRESH);
            const purchased = localStorage.getItem(STORAGE_KEYS.PURCHASED_CREDITS);

            let statusHTML = '';

            if (credits === 0) {
                statusHTML += '<div class="error"><strong>‚ùå PROBLEM DETECTED: 0 Credits</strong></div><br>';
            } else {
                statusHTML += '<div class="success"><strong>‚úÖ Credits Available</strong></div><br>';
            }

            statusHTML += '<div class="key-value"><span class="key">Credits:</span><span class="value">' + credits + '</span></div>';
            statusHTML += '<div class="key-value"><span class="key">Session ID:</span><span class="value">' + (sessionId || 'Not set') + '</span></div>';
            statusHTML += '<div class="key-value"><span class="key">Welcome Used:</span><span class="value">' + (welcomeUsed || 'false') + '</span></div>';
            statusHTML += '<div class="key-value"><span class="key">Last Refresh:</span><span class="value">' + (lastRefresh ? new Date(lastRefresh).toLocaleString() : 'Never') + '</span></div>';
            statusHTML += '<div class="key-value"><span class="key">Purchased Credits:</span><span class="value">' + (purchased || '0') + '</span></div>';

            document.getElementById('status').innerHTML = statusHTML;

            // Show all localStorage keys
            let allKeysHTML = '<strong>All localStorage keys:</strong><br><br>';
            const allKeys = Object.keys(localStorage);
            if (allKeys.length === 0) {
                allKeysHTML += '<em>No localStorage data found</em>';
            } else {
                allKeys.forEach(key => {
                    const value = localStorage.getItem(key);
                    const displayValue = value && value.length > 50 ? value.substring(0, 50) + '...' : value;
                    allKeysHTML += `<div class="key-value"><span class="key">${key}:</span><span class="value">${displayValue}</span></div>`;
                });
            }
            document.getElementById('allKeys').innerHTML = allKeysHTML;
        }

        function setCredits(amount) {
            localStorage.setItem(STORAGE_KEYS.CREDITS, amount.toString());

            // If this is first time, set up the system
            if (!localStorage.getItem(STORAGE_KEYS.SESSION_ID)) {
                const newSessionId = `edge_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                localStorage.setItem(STORAGE_KEYS.SESSION_ID, newSessionId);
                localStorage.setItem(STORAGE_KEYS.WELCOME_USED, 'false');
                localStorage.setItem(STORAGE_KEYS.LAST_REFRESH, new Date().toISOString());
                localStorage.setItem(STORAGE_KEYS.PURCHASED_CREDITS, '0');
            }

            updateStatus();
            showMessage(`‚úÖ Credits set to ${amount}!<br><br><strong>Now refresh your EarningsEdge app to see the changes.</strong>`, 'success');
        }

        function forceRefresh() {
            // Set last refresh to yesterday
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            localStorage.setItem(STORAGE_KEYS.LAST_REFRESH, yesterday.toISOString());
            localStorage.setItem(STORAGE_KEYS.WELCOME_USED, 'true');

            // Set to 25 credits
            const newAmount = 25;
            localStorage.setItem(STORAGE_KEYS.CREDITS, newAmount.toString());

            updateStatus();
            showMessage(`‚úÖ Forced daily refresh to 25 credits!<br><br><strong>Now refresh your EarningsEdge app.</strong>`, 'success');
        }

        function clearAll() {
            if (confirm('‚ö†Ô∏è Clear ALL EarningsEdge data?\n\nYou will start fresh with 10 welcome credits when you reload the app.')) {
                // Clear all EarningsEdge keys
                Object.values(STORAGE_KEYS).forEach(key => localStorage.removeItem(key));
                localStorage.removeItem('earningsEdgeSeenIntro');
                localStorage.removeItem('hasCompletedFirstAnalysis');

                updateStatus();
                showMessage('‚úÖ All data cleared!<br><br><strong>Now refresh your EarningsEdge app to start fresh.</strong>', 'warning');
            }
        }

        // Initialize
        document.getElementById('currentDomain').textContent = window.location.hostname || 'localhost';
        updateStatus();

        // Show initial message based on credit status
        const initialCredits = getCurrentCredits();
        if (initialCredits === 0) {
            showMessage(`‚ö†Ô∏è <strong>You have 0 credits!</strong><br><br>Click "Set to 25 Credits" above, then refresh your EarningsEdge app.`, 'error');
        } else {
            showMessage(`‚úÖ You have ${initialCredits} credits available.`, 'success');
        }
    </script>
</body>
</html>
